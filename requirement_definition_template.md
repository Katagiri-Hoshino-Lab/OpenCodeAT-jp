# 要件定義書 (Requirement Definition)

## プロジェクト情報
- **プロジェクト名**: [例: matrix_optimization]
- **作成日**: [YYYY-MM-DD]
- **最終更新**: [YYYY-MM-DD]

## 最適化対象
### コード取得方法
- [ ] GitHubのURL: [例: https://github.com/user/repo.git]
- [ ] 手元のファイル: [ファイルパス]
- [ ] 既存コード十分: スキップ

### 対象ファイル
- **メインファイル**: [例: matrix_multiply.c]
- **依存ファイル**: [例: utils.h, Makefile]
- **入力データ**: [例: input_1000x1000.dat]

## 最適化の度合い（目標）
### 性能目標
- **目標性能**: [例: 500 GFLOPS, 理論ピーク性能の40%]
- **現在性能**: [例: 50 GFLOPS（もしくは未測定, 実行時間のみ計測）]
- **目標改善率**: [例: 10倍向上]

### 優先度
- [ ] 実行時間最小化
- [ ] メモリ使用量最小化  
- [ ] エネルギー効率最大化
- [ ] スケーラビリティ向上
- [ ] その他: [具体的に記載]

## 概要
### アプリケーション概要
[例: 密行列積計算を行うCプログラム。科学計算のボトルネックとなっているため高速化が必要。]

### 最適化アプローチ
[例: OpenMP並列化 MPI分散 CUDA/OpenACC]

## 制約（指定）

### ハードウェア（サブシステム）
#### 選択されたスパコン
- **システム名**: [例: 不老TypeII]
- **選択理由**: [例: CUDA環境が充実、予算制約]

#### 利用可能なハードウェア
- [ ] TypeI: [利用可/不可の理由]
- [ ] TypeII: [利用可/不可の理由]  
- [ ] TypeIII: [利用可/不可の理由]
- [ ] クラウドシステム: [利用可/不可の理由]
- [ ] その他: [詳細記載]

### SSH先で使用するディレクトリ
- **作業ディレクトリ**: [例: /work/OpenCodeAT/matrix_opt]
- **データディレクトリ**: [例: /data/input_files]
- **結果保存先**: [例: /work/OpenCodeAT/matrix_opt/results]

### ジョブリソース（ノード数）
#### 段階的スケールアップ
- **Phase 1 (single-node)**: [例: 1ノード 40コア]
- **Phase 2 (multi-node)**: [例: 4ノード 160コア]
- **最大規模**: [例: 16ノード 640コア]

#### リソース制約
- **最大同時ジョブ数**: [例: 3個]
- **最大実行時間**: [例: 24時間]
- **メモリ要件**: [例: 128GB/ノード]

### ミドルウェア（コンパイラ・並列化モジュール）
#### コンパイラ選択肢
- [ ] Intel OneAPI 2024
- [ ] GCC 11.3.0
- [ ] NVIDIA HPC SDK 23.1
- [ ] その他: [詳細記載]

#### 並列化ライブラリ
- [ ] OpenMP
- [ ] MPI
- [ ] CUDA
- [ ] OpenACC
- [ ] その他: [詳細記載]

### 並列化戦略（実装順序や適用箇所）
#### 実装フェーズ
1. **Phase 1**: [例: ループ並列化（OpenMP）]
2. **Phase 2**: [例: ドメイン分割（MPI）]  
3. **Phase 3**: [例: GPU移植（CUDA）]
4. **Phase 4**: [例: ベクトル化（AVX512）]

#### 適用箇所
- **ホットスポット1**: [例: matrix_multiply関数の3重ループ]
- **ホットスポット2**: [例: data_initialization関数]
- **通信パターン**: [例: All-to-All通信でのデータ交換]

### 許容される精度（テストコード 指定/生成）
#### 精度要件
- **数値精度**: [例: 倍精度必須/単精度可]
- **許容誤差**: [例: 相対誤差 1e-12以下]
- **ビット一致**: [例: 必要/不要]

#### テストコード
- [ ] 既存テスト使用: [ファイル名: test_correctness.c]
- [ ] テスト自動生成: [要件: 複数サイズでの正確性検証]
- [ ] ベンチマーク: [例: 1000x1000, 5000x5000, 10000x10000行列]

### 予算（ジョブ）
#### 計算資源予算
- **総予算**: [例: 1000 node-hours]
- **予算閾値（推奨）**:
  - 最低消費量: [例: 100 node-hours - 基本的な実行可能性確認]
  - 想定消費量: [例: 500 node-hours - 通常の最適化作業]
  - デッドライン: [例: 1000 node-hours - プロジェクト上限]
- **Phase別配分**: 
  - Phase 1: [例: 200 node-hours]
  - Phase 2: [例: 300 node-hours]
  - Phase 3: [例: 500 node-hours]

#### 制約
- **1日あたり上限**: [例: 50 node-hours]
- **緊急時予備**: [例: 100 node-hours]

### CD(Git Agent)を使用するか
#### GitHub連携
- [ ] 使用する
- [ ] 使用しない
- [ ] 段階的導入

#### 通知設定
- [ ] hookによるメール通知: [メールアドレス]
- [ ] Slack通知: [チャンネル]
- [ ] その他: [詳細記載]

## 追加要件・制約
### セキュリティ要件
- **機密レベル**: [例: 社内限定/公開可能]
- **データ保護**: [例: 暗号化必要/不要]

### 互換性要件
- **他システム連携**: [例: 既存ワークフローとの統合]
- **結果フォーマット**: [例: CSV/HDF5/バイナリ]

### その他
[プロジェクト固有の要件や制約を記載]

---

## 自動生成情報（PM記入）
- **要件定義完了日**: [自動記入]
- **不足項目**: [自動記入]
- **推奨構成**: [自動記入]
- **初期エージェント配置**: [自動記入]